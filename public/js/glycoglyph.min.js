//  v2.0.0 Copyright 2020 Akul Mehta
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).glycoglyph={})}(this,(function(e){"use strict";var t={nameInputID:"cfg_name",glycoCTID:"glycoCT",preparedSubstituentSpan:"subscheck",preparedMonosaccharideSpan:"monocheck",preparedLinkageSpan:"linkagecheck",undodiv:"undodiv",redodiv:"redodiv",multimode:"multimode",glytoucanTableDiv:"gtcid",commonMonoList:"commonmonolist",fullMonoList:"fullmonolist"},n={monosSVG:`${window.location.protocol}//${window.location.host}/assets/images/monos.svg`,css:`${window.location.protocol}//${window.location.host}/css/glycoglyph.css`},a={child:{name:"",linkage:"",monosaccharide:"",linknum:0,substituent:"",children:[]}};let r={width:320,height:465,editingMode:!0,orientation:"bottom-to-top",drawdivID:"d3glycanstruc",symbsize:25,drawingareachoice:"fixglycansize",fucopt:"fucdown",linkageVisible:!0,linkRotate:!0,linkAbbr:!1,linkFontSize:12,margin:{top:40,right:40,bottom:40,left:40},drawingSettingsDivID:"glycoglyphDrawingSettings",userOverrideOptions:!0};var c={multimode:!1},l=["Glc","Man","Gal","Gul","Alt","All","Tal","Ido","GlcNAc","ManNAc","GalNAc","GulNAc","AltNAc","AllNAc","TalNAc","IdoNAc","GlcN","ManN","GalN","GulN","AltN","AllN","TalN","IdoN","GlcA","ManA","GalA","GulA","AltA","AllA","TalA","IdoA","Qui","Rha","6dGul","6dAlt","6dTal","Fuc","QuiNAc","RhaNAc","6dAltNAc","6dTalNAc","FucNAc","Oli","Tyv","Abe","Par","Dig","Col","Ara","Lyx","Xyl","Rib","Kdn","Neu5Ac","Neu5Gc","Neu","Sia","Pse","Leg","Aci","4eLeg","Bac","LDmanHep","Kdo","Dha","DDmanHep","MurNAc","MurNGc","Mur","Api","Fru","Tag","Sor","Psi","Hex","HexN","HexNAc"],o=["Glc","Man","Gal","GlcNAc","GalNAc","Fuc","Neu5Ac","Neu5Gc","Neu","Xyl","IdoA","GlcA","Unknown"],i=[{name:"Chitobiose-core",structure:"GlcNAcb1-4GlcNAcb1",type:"starter",subtype:"N"},{name:"N-core",structure:"Mana1-6(Mana1-3)Manb1-4GlcNAcb1-4GlcNAcb1",type:"starter",subtype:"N"},{name:"N-core-fuc",structure:"Mana1-6(Mana1-3)Manb1-4GlcNAcb1-4(Fuca1-6)GlcNAcb1",type:"starter",subtype:"N"},{name:"N-core-bis",structure:"Mana1-6(GlcNAcb1-4)(Mana1-3)Manb1-4GlcNAcb1-4GlcNAcb1",type:"starter",subtype:"N"},{name:"N-core-bis-fuc",structure:"Mana1-6(GlcNAcb1-4)(Mana1-3)Manb1-4GlcNAcb1-4(Fuca1-6)GlcNAcb1",type:"starter",subtype:"N"},{name:"N-core-hyb",structure:"Mana1-6(Mana1-3)Mana1-6(Mana1-3)Manb1-4GlcNAcb1-4GlcNAcb1",type:"starter",subtype:"N"},{name:"N-core-hyb-fuc",structure:"Mana1-6(Mana1-3)Mana1-6(Mana1-3)Manb1-4GlcNAcb1-4(Fuca1-6)GlcNAcb1",type:"starter",subtype:"N"},{name:"N-oligoman",structure:"Mana1-2Mana1-6(Mana1-2Mana1-3)Mana1-6(Mana1-2Mana1-2Mana1-3)Manb1-4GlcNAcb1-4GlcNAcb1",type:"starter",subtype:"N"},{name:"Core-1",structure:"Galb1-3GalNAca1",type:"starter",subtype:"O"},{name:"Core-2",structure:"GlcNAcb1-6(Galb1-3)GalNAca1",type:"starter",subtype:"O"},{name:"Core-3",structure:"GlcNAcb1-3GalNAca1",type:"starter",subtype:"O"},{name:"Core-4",structure:"GlcNAcb1-6(GlcNAcb1-3)GalNAca1",type:"starter",subtype:"O"},{name:"Core-5",structure:"GalNAca1-3GalNAca1",type:"starter",subtype:"O"},{name:"Core-6",structure:"GlcNAcb1-6GalNAca1",type:"starter",subtype:"O"},{name:"Core-7",structure:"GalNAca1-6GalNAca1",type:"starter",subtype:"O"},{name:"Core-8",structure:"Gala1-3GalNAca1",type:"starter",subtype:"O"}],d=[{name:"Blood Group A",sequence:"GalNAca1-3(Fuca1-2)Gal",type:"antigen"},{name:"Blood Group B",sequence:"Galb1-3(Fuca1-2)Gal",type:"antigen"},{name:"Blood Group H",sequence:"Fuca1-2Gal",type:"antigen"},{name:"CAD Antigen",sequence:"Neu5Aca2-6(GalNAcb1-4(Neu5Aca2-3)Galb1-3)GalNAc",type:"antigen"},{name:"Forsmann Antigen",sequence:"GalNAca1-3GalNAcb1-3Gal",type:"antigen"},{name:"Galili Antigen",sequence:"Gala1-3Galb1-4GlcNAc",type:"antigen"},{name:"P antigen",sequence:"GalNAcb1-3Gala1-4Galb1-4Glc",type:"antigen"},{name:"Pk antigen",sequence:"Gala1-4Galb1-4Glc",type:"antigen"},{name:"SDA Antigen",sequence:"GalNAcb1-4(Neu5Aca2-3)Galb1-4GlcNAcb1-3Gal",type:"antigen"},{name:"High Mannose Terminals",sequence:"Mana1-2Man",type:"mannose"},{name:"LacDiNAc",sequence:"GalNAcb1-4GlcNAc",type:"lactosamine"},{name:"Lactosamine",sequence:"Galb1-4GlcNAc",type:"lactosamine"},{name:"Neo-Lactosamine",sequence:"Galb1-3GlcNAc",type:"lactosamine"},{name:"Poly-Lactosamine",sequence:"Galb1-4GlcNAcb1-3Galb1-4GlcNAc",type:"lactosamine"},{name:"Lewis A",sequence:"Galb1-3(Fuca1-4)GlcNAc",type:"lewis"},{name:"Lewis B",sequence:"Fuca1-2Galb1-3(Fuca1-4)GlcNAc",type:"lewis"},{name:"Lewis C",sequence:"Galb1-3GlcNAc",type:"lewis"},{name:"Lewis D",sequence:"Fuca1-2Galb1-3GlcNAc",type:"lewis"},{name:"Lewis X",sequence:"Galb1-4(Fuca1-3)GlcNAc",type:"lewis"},{name:"Lewis Y",sequence:"Fuca1-2Galb1-4(Fuca1-3)GlcNAc",type:"lewis"}],s={Hex:{glycoct:"HEX",transform:"",configdefault:""},Glc:{glycoct:"glc-HEX",transform:"",configdefault:"d"},Man:{glycoct:"man-HEX",transform:"",configdefault:"d"},Gal:{glycoct:"gal-HEX",transform:"",configdefault:"d"},Gul:{glycoct:"gul-HEX",transform:"",configdefault:"d"},Alt:{glycoct:"alt-HEX",transform:"",configdefault:"l"},All:{glycoct:"all-HEX",transform:"",configdefault:"d"},Tal:{glycoct:"tal-HEX",transform:"",configdefault:"d"},Ara:{glycoct:"ara-PEN",transform:"",configdefault:"l"},Lyx:{glycoct:"lyx-PEN",transform:"",configdefault:"d"},Rib:{glycoct:"rib-PEN",transform:"",configdefault:"d"},Bac:{glycoct:"glc-HEX",transform:"|2:d|4:d|6:d",configdefault:"d"},Fuc:{glycoct:"gal-HEX",transform:"-1:5|6:d",configdefault:"l"},HexA:{glycoct:"HEX",transform:"|6:a",configdefault:""},GlcA:{glycoct:"glc-HEX",transform:"-1:5|6:a",configdefault:"d"},ManA:{glycoct:"man-HEX",transform:"-1:5|6:a",configdefault:"d"},GalA:{glycoct:"gal-HEX",transform:"-1:5|6:a",configdefault:"d"},GulA:{glycoct:"gul-HEX",transform:"-1:5|6:a",configdefault:"d"},AltA:{glycoct:"alt-HEX",transform:"-1:5|6:a",configdefault:"l"},AllA:{glycoct:"all-HEX",transform:"-1:5|6:a",configdefault:"d"},TalA:{glycoct:"tal-HEX",transform:"-1:5|6:a",configdefault:"d"},Qui:{glycoct:"glc-HEX",transform:"-1:5|6:d",configdefault:"d"},dHex:{glycoct:"HEX",transform:"|6:d",configdefault:""},Ido:{glycoct:"ido-HEX",transform:"",configdefault:"l"},IdoA:{glycoct:"ido-HEX",transform:"-1:5|6:a",configdefault:"l"},Pen:{glycoct:"PEN-1:4",transform:"",configdefault:""},Rha:{glycoct:"man-HEX",transform:"|6:d",configdefault:"l"},SixdAlt:{glycoct:"alt-HEX",transform:"|6:d",configdefault:"l"},SixdTal:{glycoct:"tal-HEX",transform:"|6:d",configdefault:"d"},Xyl:{glycoct:"xyl-PEN",transform:"",configdefault:"d"},ddHex:{glycoct:"HEX",transform:"|2:d|6:d",configdefault:""},Unknown:{glycoct:"unknown",transform:"",configdefault:""},Oli:{glycoct:"PEN",transform:"|3:d|6:d",configdefault:""},Tyv:{glycoct:"ara-HEX",transform:"|3:d|6:d",configdefault:""},Abe:{glycoct:"dxyl-HEX",transform:"|3:d|6:d",configdefault:""},Par:{glycoct:"rib-HEX",transform:"|3:d|6:d",configdefault:""},Col:{glycoct:"lxyl-HEX",transform:"|3:d|6:d",configdefault:""},Dig:{glycoct:"rib-HEX",transform:"|2:d|6:d",configdefault:"d"},Nonu:{glycoct:"NON",transform:"",configdefault:""},Kdn:{glycoct:"gro-dgal-NON-2:6",transform:"|1:a|2:keto|3:d",configdefault:"d"},Kdo:{glycoct:"man-OCT-2:6",transform:"|1:a|2:keto|3:d",configdefault:"d"},Fru:{glycoct:"ara-HEX-2:5",transform:"|2:keto",configdefault:"d"},Assigned:{glycoct:"assigned-PEN",transform:"",configdefault:""},LDManHep:{glycoct:"ldmanhep-HEX",transform:"",configdefault:""},DDManHep:{glycoct:"ddmanhep-HEX",transform:"",configdefault:""},Dha:{glycoct:"dha-HEX",transform:"",configdefault:""},Mur:{glycoct:"mur-HEX",transform:"",configdefault:""},Sia:{glycoct:"sia-NON",transform:"",configdefault:""},Api:{glycoct:"api-PEN",transform:"",configdefault:"l"},Tag:{glycoct:"tag-PEN",transform:"",configdefault:"d"},Sor:{glycoct:"sor-PEN",transform:"",configdefault:"l"},Psi:{glycoct:"psi-PEN",transform:"",configdefault:"d"}};function u(e){(e=(e=(e=e.replace(/ /g,"")).replace(/\((?=\d[a-zA-Z]\))/g,"[")).replace(/(\[\d[a-zA-Z])\)/g,"$1]")).indexOf("GlcN(Gc)")>-1&&(e=e.replace(/GlcN\(Gc\)/,"GlcNGc"));var t=function(e){var t=e.split(/(\)|\(|-[\d,\?]|-(?=[a-zA-z]))/g).filter((function(e){return""!==e})),n=[];for(let e=0;e<t.length-1;e++)t[e+1].search(/\-[\d,\?]/)>-1?n.push(t[e]+t[e+1]):t[e].search(/\-/)<0&&n.push(t[e]);return n.push(t[t.length-1]),n}(e);function n(e,t,n,a){let r=e.lastIndexOf("(");if("("===t)e.push(t);else if(")"===t)e.splice(r,1);else if("-"!==t){var c,o,i,d,s=t.substring(t.lastIndexOf("]")+1,t.length);s!=t&&(i=t.replace(s,""));for(let e=0;e<s.length;e++)if(!0===l.includes(s.substring(0,s.length-e))){d=+(c=s.substring(s.length-e,s.length)).substr(-1),o=s.substring(0,s.length-e);break}t.search(/Neu5\,9Ac2?/g)>-1&&(o="Neu5Ac",i="[9Ac]",d=+(c=t.replace(/Neu5\,9Ac2?/g,"")).substr(-1)),null==c&&(c=""),null==o&&(o=""),null==i&&(i=""),null==d&&(d=0);var u=c.charAt(0);/^\d+$/.test(u)&&(u="?"),/\-$/.test(c)&&(c=c.replace(/\-$/,"")),e.push({name:t,linkage:c,monosaccharide:o,substituent:i,linknum:d,anomer:u,uniqueNodeID:n,children:e.splice(r+1,e.length-r-1).reverse()})}return e}return JSON.stringify(t.reduce(n,[])[0],0,2)}function m(e,t=!1){return e.children&&e.data.children.length>0&&(t?e.children.sort((function(e,t){return d3.descending(e.data.linknum,t.data.linknum)})):e.children.sort((function(e,t){return d3.ascending(e.data.linknum,t.data.linknum)})),e.children.findIndex(e=>"Fuc"==e.data.monosaccharide)>-1&&e.depth<=1&&"GlcNAc"===e.data.monosaccharide&&e.children.findIndex(e=>"GlcNAc"==e.data.monosaccharide)>-1&&e.children.sort((e,t)=>"Fuc"==e.data.monosaccharide?-1:"Fuc"==t.data.monosaccharide?1:0),e.children.forEach(e=>{m(e,t)})),e}function g(){a.child={name:"",linkage:"",monosaccharide:"",linknum:0,substituent:"",children:[]},$("#"+t.preparedSubstituentSpan).empty(),$("#"+t.preparedMonosaccharideSpan).empty(),$("#"+t.preparedLinkageSpan).empty()}function h(e){if("Unknown"===e){var n=prompt("Please enter name for the node","");if(null==n)return void alert("Error: Name for the node was blank - did not add the node");e=n}a.child.monosaccharide=e,$("#"+t.preparedMonosaccharideSpan).empty().append(e),f()}function f(){a.child.name=a.child.substituent+a.child.monosaccharide+a.child.linkage}function p(e,t){var n="";return""!=e.data.monosaccharide&&""!=e.data.linkage?(void 0!==e.data.substituent&&"[]"!==e.data.substituent||(e.data.substituent=""),e.data.linkage&&-1===e.data.linkage.search("-")&&e.depth>0&&(e.data.linkage=e.data.linkage+"-"),n=e.data.substituent+e.data.monosaccharide+e.data.linkage+n):n=""==e.data.linkage&&null==e.parent?e.data.name+n:e.data.name+"-"+n,t>1&&(n+=")"),e.data.children&&e.data.children.length>0&&e.children.forEach((t,a)=>{n=p(t,e.children.length-a)+n}),t>1&&(n="("+n),n}function y(n){e.tracknum>-1&&$("#"+t.undodiv).removeClass("hide").addClass("show"),e.trackname[e.tracknum]!=n?(e.tracknum++,e.trackname[e.tracknum]=n,e.trackname=e.trackname.filter((t,n)=>n<=e.tracknum),e.tracknum<e.trackname.length&&$("#"+t.redodiv).addClass("hide").removeClass("show")):console.log("not adding")}function b(){var e=document.getElementById(t.nameInputID).value;if(""!==e){var n=A(u(e)).replace(/\n/g,"<br>");document.getElementById(t.glycoCTID).innerHTML=n}else alert("No name typed. Please check Name above.")}function A(e){var t=JSON.parse(e);t=d3.hierarchy(t);var n="RES\n",a=1,r="LIN\n",c=1;return function e(t,l=1){var o=t.data,i=o.monosaccharide,d=a,u=function(e){if(""===t)return[];var t=[];"object"==typeof(t=(t=e.replace(/\[(?=[0-9a-zA-Z])/g,"").replace(/\](?=[0-9a-zA-Z])/g,",").replace("]","")).split(/,/g))&&(t=[t]);return t}(o.substituent).pop(),m="";m=null==o.anomer?"x":""===o.anomer||"-"===o.anomer?"o":"?"==o.anomer?"x":o.anomer;var g="";i.indexOf("NAc")>-1?(g=i.split("NAc")[0],u.unshift("NAc")):i.indexOf("NGc")>-1?(g=i.split("NGc")[0],u.unshift("NGc")):"Neu5Ac"===i?(g="Kdn",u.unshift("5Ac")):"Neu5Gc"===i?(g="Kdn",u.unshift("5Gc")):i.indexOf("N")>-1&&s.hasOwnProperty(i.replace(/N/g,""))?(g=i.replace(/N/g,""),u.unshift("N")):g=i;var h=function(e,t){if("o"===t)return"0:0";var n="Gal,Glc,Man,GalNAc,GlcNAc,ManNAc,Fuc,Neu5Ac,Neu5Gc,Neu,Sia,Xyl,IdoA,GlcA,\n  GalA,GlcA,ManA,GlcN,GalN,ManN,Hex,HexNAc,HexA,HexN\n  ",a="Rib,Api,Ara";if(n=n.split(/,/g),a=a.split(/,/g),n.includes(e))return"1:5";if(a.includes(e))return"1:4";return"x:x"}(i,m);if(s.hasOwnProperty(g)&&(""==s[g].transform?(n+=a+"b:"+m+"-"+s[g].configdefault+s[g].glycoct+"-"+h+s[g].transform,"o"===m&&(n+="|1:aldi")):n+=a+"b:"+m+"-"+s[g].configdefault+s[g].glycoct+s[g].transform,n+="\n",a++),""!==o.linkage&&"?"!==o.linkage&&1!=c){var f=o.linkage,p=f.charAt(f.length-1),y=f.charAt(f.indexOf("-")-1);"?"===p&&(p="-1"),"?"===y&&(y="1"),r+=`${c}:${l}o(${p}+${y})${d}d\n`,c++}return(u=u.filter(e=>""!==e)).forEach(e=>{var t,l;switch(!0){case"NAc"===e:t=2,l="n-acetyl";break;case"NGc"===e:t=2,l="n-glycolyl";break;case e.indexOf("Ac")>-1:t=e.split(/(?!\d)/g)[0],l="acetyl","Neu5Ac"===i&&5==t&&(l="n-acetyl");break;case e.indexOf("Gc")>-1:t=e.split(/(?!\d)/g)[0],l="glycolyl","Neu5Gc"===i&&(l="n-glycolyl");break;case e.indexOf("Me")>-1:t=e.split(/(?!\d)/g)[0],l="methyl";break;case e.indexOf("N")>-1:t=2,l="amino";break;case e.indexOf("S")>-1:t=e.split(/(?!\d)/g)[0],l="sulfate";break;case e.indexOf("P")>-1:t=e.split(/(?!\d)/g)[0],l="phospho";break;default:t=e.charAt(0),l=e.split(/(?!\d)/g)[1]}n+=`${a}s:${l}\n`,r+=`${c}:${d}d(${t}+1)${a}n\n`,c++,a++}),t.data.children.length>0&&t.children.forEach(t=>e(t,d)),t}(t),("LIN\n"!==r?n+r:n).trim()}function N(e){var n=p(m(d3.hierarchy(e)));y(n),document.getElementById(t.nameInputID).value=n,G(n),b()}function v(e,n){if(""==a.child.monosaccharide)return alert("No monosaccharide selected. \n\nPlease select a monosaccharide to add."),g(),void $("#"+t.multimode).empty();""===a.child.linkage&&(a.child.linkage="??-?");var r=document.getElementById(t.nameInputID).value,c=JSON.parse(u(r)),l=0,o=!1;!function t(n){if(n.name===e[l].data.name)if(l<e.length-1){l++;var r=n.children.findIndex(t=>t.name===e[l].data.name&&t.uniqueNodeID===e[l].data.uniqueNodeID);t(n.children[r])}else n.children.forEach(e=>{e.linknum==a.child.linknum&&(o=!0,alert("You are trying to add a node to a position which is occupied. \nTwo nodes cannot have same linkage acceptor position. \nPlease check the linkages."))}),!1===o&&n.children.push(a.child);return n}(c),N(c),!1===o&&0==n&&g()}function k(e,n){if(1==e.length)return N(a.child),void g();if(""!=a.child.monosaccharide||""!=a.child.linkage||""!=a.child.substituent){var r=document.getElementById(t.nameInputID).value,c=JSON.parse(u(r)),l=0;!function t(n){if(n.name===e[l].data.name)if(l<e.length-2){l++;var r=n.children.findIndex(t=>t.name===e[l].data.name&&t.uniqueNodeID===e[l].data.uniqueNodeID);t(n.children[r])}else{r=n.children.findIndex(t=>t.name===e[l+1].data.name);if(""!=a.child.linkage){var c=n.children.findIndex(e=>e.linknum===a.child.linknum);if(c>-1&&c!=r)return void alert("Two nodes cannot have same linkage position. Please check linkages.");n.children[r].linkage=a.child.linkage,n.children[r].linknum=a.child.linknum}""!=a.child.monosaccharide&&(n.children[r].monosaccharide=a.child.monosaccharide),""!=a.child.substituent?n.children[r].substituent=a.child.substituent:"[]"==a.child.substituent&&(n.children[r].substituent=""),n.children[r].name=n.children[r].substituent+n.children[r].monosaccharide+n.children[r].linkage}return n}(c),N(c),!1===n&&g()}else alert("No replacement criteria selected. Please select what would you like to replace with.")}function x(e){if(1==e.length)return document.getElementById(t.nameInputID).value="",$("#d3glycanstruc").empty(),void $("#glycoCT").html("");var n=document.getElementById(t.nameInputID).value,a=JSON.parse(u(n)),r=0;!function t(n){if(n.name===e[r].data.name)if(r<e.length-2){r++;var a=n.children.findIndex(t=>t.name===e[r].data.name&&t.uniqueNodeID===e[r].data.uniqueNodeID);t(n.children[a])}else{a=n.children.findIndex(t=>t.name===e[r+1].data.name&&t.uniqueNodeID===e[r+1].data.uniqueNodeID);n.children.splice(a,1)}return n}(a),N(a),g()}function G(e,t){let a=JSON.parse(JSON.stringify(r));if(void 0!==t)for(var l in t)void 0!==t[l]&&(a[l]=t[l]);if(!0===a.userOverrideOptions&&(a=function(e){let t=document.querySelector(`#${e.drawingSettingsDivID} form`);if(!t)return console.warn("GlycoGlyph: No settings div found, using default options."),e;return t.querySelectorAll("input, select, checkbox").forEach(t=>{"checkbox"===t.type?e[t.id]=t.checked:"number"===t.type?e[t.id]=+t.value:e[t.id]=t.value}),e}(a)),"right-to-left"===a.orientation){let e=a.width;a.width=a.height,a.height=e}var o=u(e),i=JSON.parse(o),d=function e(t){var n=0;t.children&&t.children.forEach((function(t){var a=e(t);a>n&&(n=a)}));return 1+n}(i),s=a.margin;let g,h;"right-to-left"==a.orientation?g=a.height-s.top-s.bottom:h=a.width-s.left-s.right,"fixdrawingarea"===a.drawingareachoice?"right-to-left"==a.orientation?h=a.width-s.left-s.right:g=a.height-s.top-s.bottom:"fixglycansize"===a.drawingareachoice&&d<=2||"fixglycansize"===a.drawingareachoice&&d<9?"right-to-left"==a.orientation?h=50*d:g=50*d:"fixglycansize"===a.drawingareachoice&&d>=9&&("right-to-left"==a.orientation?h=a.width-s.top-s.bottom:g=a.height-s.top-s.bottom);var f={"right-to-left":{size:[g,h],x:function(e){return h-e.y},y:function(e){return e.x}},"bottom-to-top":{size:[h,g],x:function(e){return e.x},y:function(e){return g-e.y}}};d3.select(`#${a.drawdivID}sub`).remove(),"bottom-to-top"===a.orientation?d3.select("#"+a.drawdivID).style("flex-direction","column-reverse"):d3.select("#"+a.drawdivID).style("flex-direction","row-reverse");d3.select("#"+a.drawdivID).append("div").attr("id",a.drawdivID+"sub");var p,y=d3.select(`#${a.drawdivID}sub`).append("svg").attr("id",a.drawdivID+"SVG").attr("width",h+s.left+s.right).attr("height",g+s.top+s.bottom).append("g").attr("id","glycang").attr("transform","translate("+s.left+","+s.top+")"),b=f[a.orientation],A=d3.tree().size(b.size),N=d3.hierarchy(i);("right-to-left"==a.orientation&&(N=m(N,!0)),function(e,t){if("fucoriginal"===t.fucopt)return;let n=t.width-t.margin.left-t.margin.right;"right-to-left"===t.orientation&&(n=t.height-t.margin.top-t.margin.bottom);var a=e.x;e.each(e=>{if("Fuc"===e.data.monosaccharide){if(0===e.depth)return;e.parent.children[0].x,e.parent.children[e.parent.children.length-1].x,e.parent.children.filter(e=>-1===e.data.name.search("Fuc")).length,e.parent.children.length;e.y=e.parent.y;var r,c=e.parent.x;"fucout"===t.fucopt&&(e.x<a?e.x=e.parent.x-n/5:e.x>a?e.x=e.parent.x+n/5:e.x==a?e.parent.x<a?e.x=e.parent.x-n/5:e.parent.x>a?e.x=e.parent.x+n/5:e.x=e.parent.x-n/5:e.x=e.parent.x-n/5),"fucdown"===t.fucopt&&(e.x<e.parent.x?e.x=e.parent.x-n/5:e.x=e.parent.x+n/5),"fucleft"===t.fucopt&&(e.x=e.parent.x-n/5),e.parent.children.forEach(e=>{"Fuc"!==e.data.monosaccharide&&null==r&&(r=e.x-c)}),e.parent.children.forEach((t,n)=>{"Fuc"!==t.data.monosaccharide&&t.data.name!==e.parent.data.name&&t.each(e=>{e.x=e.x-r})})}})}(N=A(N),a),"right-to-left"==a.orientation)?0!=(p=N.x-g/2)&&(d<10?d3.select("#glycang").attr("transform","translate("+(h+s.left-50*d)+","+(s.top-p)+")"):d3.select("#glycang").attr("transform","translate("+s.left+","+(s.top-p)+")")):0!=(p=N.x-h/2)&&d3.select("#glycang").attr("transform","translate("+(s.left-p)+","+s.top+")");var G=N.descendants().slice(1);y.selectAll(".glyd3link").data(G).enter().append("path").attr("d",(function(e){return"M"+b.x(e)+","+b.y(e)+"L"+b.x(e.parent)+","+b.y(e.parent)})).attr("stroke-width",2).attr("stroke","black");var w=y.selectAll(".node").data(N.descendants()).enter().append("g").attr("transform",(function(e){return function(e,t,n){if(0===e.depth)return"translate("+t.x(e)+","+t.y(e)+")";if("right-to-left"===n.orientation)return"translate("+t.x(e)+","+t.y(e)+")";return"fucoriginal"===n.fuctype||"Fuc"!==e.data.monosaccharide?"translate("+t.x(e)+","+t.y(e)+")":(e.y=e.y+4,e.x<e.parent.x?"translate("+t.x(e)+","+t.y(e)+") rotate(-30)":"translate("+t.x(e)+","+t.y(e)+") rotate(30)")}(e,b,a)}));let S=w.append("use").attr("xlink:href",(function(e,t){return function(e,t,a){if("gp"===a&&0===t)return;if(null!=e.data.monosaccharide)var r=e.data.monosaccharide;else r=e.data.name;return""!=r?`${n.monosSVG}#${r.toLowerCase()}`:n.monosSVG+"#unknown"}(e,t,"glycan")})).attr("x",-a.symbsize/2).attr("y",-a.symbsize/2).attr("height",a.symbsize).attr("width",a.symbsize).attr("class","symbol");!0===a.editingMode&&S.on("click",(function(e){var t=N.path(e),n=Array.from(document.querySelectorAll("#modelist input")),a=n.length&&n.find(e=>e.checked).value;"add"===a?v(t,!!c.multimode):"replace"===a?k(t,!!c.multimode):"delete"===a&&x(t)})).on("mouseover",(function(e){d3.select(this.parentElement).append("circle").attr("class","highlightnode").attr("r",a.symbsize/2+10).attr("fill",(function(e){var t=Array.from(document.querySelectorAll("#modelist input")),n=t.length&&t.find(e=>e.checked).value;return"add"===n?(d3.select(this.parentElement).selectAll(".symbol").classed("addcursor",!0).classed("replacecursor",!1).classed("deletecursor",!1),"#227093"):"replace"===n?(d3.select(this.parentElement).selectAll(".symbol").classed("replacecursor",!0).classed("addcursor",!1).classed("deletecursor",!1),"#FFBA3B"):"delete"===n?(d3.select(this.parentElement).selectAll(".symbol").classed("deletecursor",!0).classed("addcursor",!1).classed("replacecursor",!1),"#7D1515"):void 0})).attr("fill-opacity",.4).lower(),$(document).bind("keyup",t=>{"Delete"!=t.originalEvent.key&&"d"!=t.originalEvent.key||$.when($(document).unbind("keyup")).then(t=>{x(N.path(e))})})})).on("mouseout",(function(e){$(document).unbind("keyup"),d3.selectAll(".highlightnode").remove()})),!0===a.linkageVisible&&w.append("text").attr("transform",(function(e,t){return function(e,t,n){if(t>0){var a=180*Math.atan2(e.y-e.parent.y,e.parent.x-e.x)/Math.PI;if("right-to-left"===n.orientation){var r;if(r=n.linkAbbr?2:4,"Fuc"===e.data.monosaccharide&&"fucoriginal"!=n.fuctype)return a<=45?(a=90,`translate(${(e.y-e.parent.y)/2+n.linkFontSize/2},${(e.parent.x-e.x)/2}) rotate(${a})`):(a=-90,`translate(${(e.y-e.parent.y)/2-n.linkFontSize/2},${(e.parent.x-e.x)/2}) rotate(${a})`);if(0==n.linkRotate)switch(!0){case e.x<e.parent.x:return`translate(${(e.y-e.parent.y)/2+n.linkFontSize},${(e.parent.x-e.x)/2-n.linkFontSize})`;case e.x===e.parent.x:return`translate(${(e.y-e.parent.y)/2},${(e.parent.x-e.x)/2-n.linkFontSize/2})`;case e.x>e.parent.x:return`translate(${(e.y-e.parent.y)/2+n.linkFontSize},${(e.parent.x-e.x)/2+n.linkFontSize})`}return a=180*Math.atan2(e.parent.x-e.x,e.y-e.parent.y)/Math.PI,`translate(${(e.y-e.parent.y)/2},${(e.parent.x-e.x)/2-n.linkFontSize/2}) rotate(${a})`}if("Fuc"===e.data.monosaccharide&&"fucoriginal"!=n.fuctype&&e.depth>0&&(a=e.x<e.parent.x?30:150),"Fuc"===e.data.monosaccharide&&"fucoriginal"!=n.fuctype)return a<=45?"translate("+(e.parent.x-e.x-10)/2+","+(e.y-e.parent.y+25)/2+") rotate("+a+")":(a=-30,"translate("+(e.parent.x-e.x+10)/2+","+(e.y-e.parent.y+30)/2+") rotate("+a+")");if(0==n.linkRotate)switch(r=n.linkAbbr?2:4,!0){case e.x<e.parent.x:return"translate("+(e.parent.x-e.x-6*n.linkFontSize+n.linkFontSize*r)/(n.linkFontSize/2)+","+(e.y-e.parent.y+5)/2+")";case e.x===e.parent.x:return"translate("+(e.parent.x-e.x+6*n.linkFontSize+n.linkFontSize*r)/(n.linkFontSize/2)+","+(e.y-e.parent.y+5)/2+")";case e.x>e.parent.x:return"translate("+(e.parent.x-e.x+6*n.linkFontSize-n.linkFontSize*r)/(n.linkFontSize/2)+","+(e.y-e.parent.y+5)/2+")"}return"translate("+(e.parent.x+10-e.x)/2+","+(e.y-e.parent.y)/2+") rotate("+a+")"}return`translate(${n.symbsize/4},${n.symbsize})`}(e,t,a)})).text((function(e,t){return function(e,t,n){var a=e.data.linkage;if(""==a)return;if(0==t)return a=a.replace("a","α").replace("b","β");let r=n.linkAbbr;if("bottom-to-top"===n.orientation&&"Fuc"===e.data.monosaccharide&&e.x>e.parent.x)return 1==r&&(a=a.replace(/[\d\?]\-/g,"")),a=(a=a.split("").reverse().join("")).replace(/a/gi,"α").replace(/b/gi,"β");if(1==r)return a=a.replace(/a(?=[\d\?]?\-[\d\?])/g,"α").replace(/b(?=[\d\?]?\-[\d\?])/,"β").replace(/[\d\?]\-/g,"");return a.search(/[a,b,\?][\d,\?]\-[\d,\?]/)>-1?(a.search(/a[\d,\?]\-[\d,\?]/)>-1?a=a.replace(/a(?=[\d\?]\-[\d\?])/,"α"):a.search(/b[\d\?]\-[\d\?]/)>-1&&(a=a.replace(/b(?=[\d\?]\-[\d\?])/,"β")),a.substr(a.indexOf("-")-2)):a.search(/[a,b,\?]\-/)>-1?a.substr(a.indexOf("-")-1):a.search(/[a,b,\?][\d,\?]/)>-1?"a"===a.charAt(a.length-2)?"α"+a.charAt(a.length-1):"b"===a.charAt(a.length-2)?"β"+a.charAt(a.length-1):a:"a"===a?"α":"b"===a?"β":a}(e,t,a)})).attr("font-size",a.linkFontSize).attr("text-anchor","middle").style("font-family","Arial,Sans");let E=w.append("text").text((function(e){return function(e){if(null==e.data.substituent){t="";return}var t=e.data.substituent;return t=t.replace(/\[(?=[0-9a-zA-Z])/g,"").replace(/\](?=[0-9a-zA-Z])/g,",").replace("]","")}(e)})).attr("font-size",a.linkFontSize).style("font-family","Arial,Sans");"bottom-to-top"===a.orientation?E.attr("x",-a.linkFontSize-3).attr("y",3).attr("text-anchor","end"):E.attr("x",3).attr("y",a.linkFontSize+a.symbsize/2).attr("text-anchor","middle")}function w(e,t){const n=d3.select("#"+t).append("div").attr("class","monodiv").append("div").attr("id",t+"btn"+e.id).attr("class","monobtndiv").attr("title",e.id+" OR "+e.fullname).attr("data-abbr",e.id).on("mouseup",(function(){h(this.dataset.abbr)})).append("svg").attr("id","mono"+e.id).attr("viewBox",e.viewBox).attr("xmlns","http://www.w3.org/2000/svg").attr("width","55").attr("height","35");n.append("g").attr("transform","scale(0.5 0.5) translate(25,0)").html(e.innerhtml);n.append("g").attr("transform","translate(50%,50)").append("text").text(e.id).attr("text-anchor","middle").attr("x","50%").attr("y","90%").attr("font-size","1em")}function S(e){$("#"+t.glytoucanTableDiv).html('\n    <table class="table table-sm">\n      <thead>\n        <tr>\n          <th class="">Reducing End Type:</th>\n          <th class="alpha" scope="col">&alpha;</th>\n          <th class="beta" scope="col">&beta;</th>\n          <th class="unknown" scope="col">Unknown (?)</th>\n          <th class="open"  scope="col">Open</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr>\n          <td>GlyTouCan ID:</th>\n          <td class="alpha" id="alphagtcid"></td>\n          <td class="beta" id="betagtcid"></td>\n          <td class="unknown" id="unknowngtcid"></td>\n          <td class="open" id="opengtcid"></td>\n        </tr>\n        <tr>\n          <td>Details:</th>\n          <td class="alpha" id="alphadetails"></td>\n          <td class="beta" id="betadetails"></td>\n          <td class="unknown" id="unknowndetails"></td>\n          <td class="open" id="opendetails"></td>\n      </tr>\n      </tbody>\n    </table>\n    '),e.forEach(e=>{"Error in Structure"==e.glytoucan.response?$(`#${e.name}gtcid`).html("Error in Structure"):"Not Available"==e.glytoucan.response?$(`#${e.name}gtcid`).html("Not Available"):"Error Connecting"==e.glytoucan.response?$(`#${e.name}gtcid`).html("Error Connecting"):($(`#${e.name}gtcid`).html(`${e.glytoucan.id} \n      <button id="copyGlycoCTBtn" class="btn btn-sm btn-link copybtn" onclick="glycoglyph.copyTextFromElement('${e.name}gtcid')" title="Copy">\n        <img src="/assets/images/copy.svg" alt="copy" width="20px">\n      </button>\n      `),$(`#${e.name}details`).append(`\n      <a href="https://glytoucan.org/Structures/Glycans/${e.glytoucan.id}" target="_blank"\n      title="View in GlyTouCan">\n      <span class="glytoucan-logo detail-icon"></span></a>`),e.glygenData.glygen.url&&($(`#${e.name}details`).append(`\n          <a href="${e.glygenData.glygen.url}" target="_blank"\n          title="View in GlyGen">\n          <span class="glygen-logo detail-icon"></span></a>\n          `),e.glygenData.pubchem&&$(`#${e.name}details`).append(` \n            <a href="${e.glygenData.pubchem.url}" target="_blank"\n            title="View in PubChem">\n            <span class="pubchem-logo detail-icon"></span></a>`),e.glygenData.chebi&&$(`#${e.name}details`).append(` \n            <a href="${e.glygenData.chebi.url}" target="_blank"\n            title="View in ChEBI">\n            <span class="chebi-logo detail-icon"></span></a>`))),e.primary&&d3.selectAll("."+e.name).classed("table-success",!0)})}async function E(e){return await fetch(e).then(e=>e.json()).then(e=>void 0===e.id?{id:e.id,response:"Error in Structure"}:"no accnumber"===e.id?{id:e.id,response:"Not Available"}:{id:e.id,response:"Success"}).catch(e=>(console.error(e),{id:void 0,response:"Error Connecting"}))}async function I(e){return fetch(`https://api.glygen.org/glycan/detail/${e}/`).then(e=>e.json()).then(t=>{let n={};if(n.glygen={url:"https://www.glygen.org/glycan/"+e,response:"Success"},t.crossref){let e=t.crossref.find(e=>"PubChem Compound"===e.database);e&&(n.pubchem={url:e.url,response:"Success"});let a=t.crossref.find(e=>"ChEBI"===e.database);a&&(n.chebi={url:a.url,response:"Success"})}return n}).catch(e=>(console.error(e),e.responseJSON.error_list.some(e=>"non-existent-record"===e.error_code)?(console.log("GlyTouCan ID does not exist in glygen"),{glygen:{url:void 0,response:"Not Available"}}):(console.log("Failed to connect to GlyGen"),{glygen:{url:void 0,response:"Error in connection"}})))}async function D(e){let t,n=[{anomer:"a",name:"alpha"},{anomer:"b",name:"beta"},{anomer:"?",name:"unknown"},{anomer:"",name:"open"}],a=JSON.parse(u(e));a=function e(t){return""!=t.monosaccharide?t:e(t.children[0])}(a),""!==a.monosaccharide&&(t=a.anomer);for(let e=0;e<n.length;e++){a.anomer=n[e].anomer;let r=A(JSON.stringify(a)),c="https://api.glycosmos.org/glycanformatconverter/2.3.2-snapshot/glycoct2wurcs/";c+=encodeURI(r),n[e].primary=n[e].anomer==t,n[e].glytoucan=await E(c),"Success"==n[e].glytoucan.response&&(n[e].glygenData=await I(n[e].glytoucan.id))}return n}e.tracknum=-1,e.trackname=[],e.addLinkage=function(){var e=Array.from(document.querySelectorAll("#orientlist input")),n=e.length&&e.find(e=>e.checked).value,r=Array.from(document.querySelectorAll("#anoposlist input")),c=r.length&&r.find(e=>e.checked).value,l=Array.from(document.querySelectorAll("#acclist input")),o=l.length&&l.find(e=>e.checked).value;a.child.linknum="?"==o?0:+o;var i=n+c+"-"+o;$("#"+t.preparedLinkageSpan).empty().append(i),a.child.linkage=i,f()},e.addSub=function(){var e=Array.from(document.querySelectorAll("#subposlist input")),n=e.length&&e.find(e=>e.checked).value,r=Array.from(document.querySelectorAll("#subtypelist input")),c=r.length&&r.find(e=>e.checked).value;"other"===c&&(c=document.getElementById("substituentother").value);var l="["+(n+c)+"]";$("#"+t.preparedSubstituentSpan).append(l),a.child.substituent=a.child.substituent+l,f()},e.addTerminaltoChild=function(e){let t=d[e].sequence;a.child=JSON.parse(u(t)),$("#monocheck").html(t),$("#linkagecheck").html("<i>Add Linkage</i>")},e.addfirstmono=function(){let e=a.child;if(""===e.linkage){let t=prompt('You have not added any linkage for the first monosaccharide.\n    \nThis will be treated as an open ring. If this is what you desire leave the field below blank and press OK.\n    \nTo indicate a closed ring please type in the linkage information: \n    \nFor example:\n    \n"??" if linkage position is unknown in both anomeric configuratio and position or \n    \n"?1" where 1 indicates the position number and can be replaced with the position you desire.  or\n    \n"b1" where b indicates the anomeric configuration and 1 indicates the position.\n    ',"");e.linkage=null==t||""==t?"":t}else e.linkage=e.linkage.split(/\-/g)[0];e.name=e.substituent+e.monosaccharide+e.linkage,N(e),r.multimode||g()},e.addmono=v,e.appendTerminals=function(){d.forEach((e,t)=>{$("#terminalslist").append(`\n    <li class="template">\n    <button class="btn btn-outline-primary btn-sm"\n      onclick="glycoglyph.addTerminaltoChild(${t})">${e.name}</button>\n    </li>\n  `)})},e.cfgToGlycoCT=b,e.childglycan=a,e.clearSub=function(){$("#"+t.preparedSubstituentSpan).empty(),a.child.substituent="",f()},e.cleardrawingarea=function(){document.getElementById(t.nameInputID).value="",document.getElementById(t.glycoCTID).innerHTML="",y(""),d3.select(`#${r.drawdivID}sub`).remove()},e.commonMonos=o,e.copyTextFromElement=function(e){let t=document.getElementById(e),n=t.textContent;var a;"INPUT"==t.tagName&&(n=t.value),a=n,navigator.clipboard.writeText(a),alert("Copied")},e.d3glycanstructure=G,e.domElements=t,e.drawGTCIDTable=S,e.drawingSettings=r,e.dynamicDrawingSettings=c,e.filePaths=n,e.gctMonoList=s,e.gctSubList={NAcetyl:{glycoct:"n-acetyl"},Amino:{glycoct:"amino"},NGlycolyl:{glycoct:"n-glycolyl"},Methyl:{glycoct:"methyl"},Acetyl:{glycoct:"acetyl"},Sulfate:{glycoct:"sulfate"},Phosphate:{glycoct:"phosphate"},Bromo:{glycoct:"bromo"},Chloro:{glycoct:"chloro"},Ethyl:{glycoct:"ethyl"},Ethanolamine:{glycoct:"ethanolamine"},Fluoro:{glycoct:"fluoro"},Formyl:{glycoct:"formyl"},Hydroxymethyl:{glycoct:"hydroxymethyl"},Imino:{glycoct:"imino"},RLactate1:{glycoct:"(r)-lactate"},SLactate1:{glycoct:"(s)-lactate"},NAlanine:{glycoct:"n-alanine"},NFormyl:{glycoct:"n-formyl"},NMethyl:{glycoct:"n-methyl"},NSuccinate:{glycoct:"n-succinate"},NSulfate:{glycoct:"n-sulfate"},NTrifluoroacetyl:{glycoct:"n-trifluoroacetyl"},Nitrate:{glycoct:"nitrate"},Pyruvate:{glycoct:"pyruvate"},Thio:{glycoct:"thio"},RPyruvate:{glycoct:"(r)-pyruvate"},SPyruvate:{glycoct:"(s)-pyruvate"},RLactate2:{glycoct:"(r)-lactate2"},SLactate2:{glycoct:"(s)-lactate2"},Unknown:{glycoct:"unknown"}},e.generateGTCIDTable=async function(){if(!$("#"+t.glytoucanTableDiv))return void console.error("Glytoucan Table Div not found or no name input. Check your code.");if($("#"+t.glytoucanTableDiv).html("\n      Searching...\n    "),""==$("#"+t.nameInputID)[0].value)return void $("#"+t.glytoucanTableDiv).html("\n      No structure created. Draw a structure or enter a name and then try again.\n    ");let e=document.getElementById(t.nameInputID).value;S(await D(e))},e.getGTCID=D,e.glycantojson=u,e.jsonToGlycoCT=A,e.listMonosaccharides=async function(){var e=await d3.xml(n.monosSVG).then((function(e){return[].map.call(e.querySelectorAll("symbol"),(function(e){return{id:e.getAttribute("data-abbr"),viewBox:e.getAttribute("viewBox"),innerhtml:e.innerHTML.replace(/\n|\t/g,"").trim(),fullname:e.getAttribute("data-shortname")}}))}));e.forEach(e=>{w(e,t.fullMonoList)}),o.forEach(n=>{w(e.find(e=>e.id==n),t.commonMonoList)})},e.makechildglycanname=f,e.monos=l,e.monoselect=h,e.objecttoname=p,e.outputname=N,e.redo=function(){if(e.tracknum++,e.tracknum!=e.trackname.length){var n=document.getElementById(t.nameInputID);null!=e.trackname[e.tracknum]&&(n.value=e.trackname[e.tracknum],""!=n.value?G(n.value):$("#"+r.drawdivID).empty()),e.tracknum===e.trackname.length-1&&$("#"+t.redodiv).addClass("hide").removeClass("show"),e.tracknum<e.trackname.length&&$("#"+t.undodiv).removeClass("hide").addClass("show")}},e.replacemono=k,e.resetchildglycan=g,e.savesvg=async function(e){await async function(e){(await d3.text(n.css).then((function(e){return e}))).replace(/\/\*.*\n*\*\//g,"").replace(/\r?\n|\r/g,"").split("}").forEach((function(t){if(""!=t.trim()){var n=t.split("{"),a=n[0].trim();n[1].split(";").forEach((function(t){if(""!=t.trim()){var n=t.split(":"),r=n[0].trim(),c=n[1].trim();"font-weight"==r?d3.select("#"+e).selectAll(a).each((function(e,t){this.getAttribute(r)||this.style[r]===c||d3.select(this).style(r+"",c+"")})):d3.select("#"+e).selectAll(a).each((function(e,t){this.getAttribute(r)||this.style[r]||d3.select(this).style(r+"",c+"")}))}}))}}))}(e),await async function(e){var t=await d3.xml(n.monosSVG).then((function(e){return[].map.call(e.querySelectorAll("symbol"),(function(e){return{id:e.getAttribute("data-abbr"),viewBox:e.getAttribute("viewBox"),innerhtml:e.innerHTML.replace(/\n|\t/g,"").trim(),fullname:e.getAttribute("data-shortname")}}))}));$(`#${e} use`).each((function(e){var n=this.getAttribute("href");if(null!==n){var a=n.split("#")[1],r=this.getAttribute("x"),c=this.getAttribute("y"),l=this.getAttribute("height"),o=this.getAttribute("width"),i=t.find(e=>e.id.toLowerCase()==a),d='<svg id="'+a+'" x="'+r+'" y="'+c+'" height="'+l+'" width="'+o+'" viewBox="'+i.viewBox+'">';d+=i.innerhtml,d+="</svg>",$(this).parent().prepend(d)}})).remove()}(e);var a=document.getElementById(e);a.setAttribute("xmlns","http://www.w3.org/2000/svg"),a.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),a=document.getElementById(e).outerHTML;var r=new Blob([a],{type:"image/svg+xml;charset=utf-8"}),c=URL.createObjectURL(r),l=document.createElement("a");l.href=c,l.download="Figure.svg",document.body.appendChild(l),l.click(),document.body.removeChild(l),G(document.getElementById(t.nameInputID).value)},e.setCSSPath=async function(e,t){t&&"absolute"!==t||(n.css=`${window.location.protocol}//${window.location.host}${e}`),"relative"===t&&(n.css=e)},e.setMonosSVGPath=async function(e,t){"absolute"===t&&(n.monosSVG=`${window.location.protocol}//${window.location.host}${e}`),"relative"===t&&(n.monosSVG=e)},e.sortchildren=m,e.starttemplate=function(e){var n=document.getElementById(t.nameInputID);if(""==n.value||confirm("This will clear current Name field. Are you sure you would like to continue?")){n.value="";var a=i.filter(t=>t.name==e&&"starter"===t.type);n.value=a[0].structure,y(n.value),G(n.value),b()}},e.templates=i,e.terminals=d,e.tracknames=y,e.undo=function(){if(0!=e.tracknum){var n=document.getElementById(t.nameInputID);e.tracknum--,null!=e.trackname[e.tracknum]&&(n.value=e.trackname[e.tracknum],""!=n.value?G(n.value):$("#"+r.drawdivID).empty()),0===e.tracknum&&$("#"+t.undodiv).addClass("hide").removeClass("show"),e.tracknum<e.trackname.length&&$("#"+t.redodiv).removeClass("hide").addClass("show")}},Object.defineProperty(e,"__esModule",{value:!0})}));
